---
# generated by https://github.com/hashicorp/terraform-plugin-docs
page_title: "harness_chaos_security_governance_condition Resource - terraform-provider-harness"
subcategory: "Next Gen"
description: |-
  Resource for managing a Harness Chaos Security Governance Condition
---

# harness_chaos_security_governance_condition (Resource)

Resource for managing a Harness Chaos Security Governance Condition

## Example Usage

```terraform
# Example of a Kubernetes Security Governance Condition
resource "harness_chaos_security_governance_condition" "k8s_condition" {
  org_id      = var.org_id
  project_id  = var.project_id
  name        = "k8s-security-condition"
  description = "Security governance condition for Kubernetes workloads"
  infra_type  = "KubernetesV2"

  fault_spec {
    operator = "NOT_EQUAL_TO"

    faults {
      fault_type = "FAULT"
      name       = "pod-delete"
    }

    faults {
      fault_type = "FAULT"
      name       = "pod-dns"
    }
  }

  k8s_spec {
    infra_spec {
      operator  = "EQUAL_TO"
      infra_ids = [var.k8s_infra_id]
    }

    application_spec {
      operator = "EQUAL_TO"

      workloads {
        namespace          = "default"
        kind               = "deployment"
        label              = "app=nginx"
        services           = ["nginx-service"]
        application_map_id = "nginx-app"
      }
    }

    chaos_service_account_spec {
      operator         = "EQUAL_TO"
      service_accounts = ["default", "chaos-service-account"]
    }
  }

  tags = ["env:prod", "team:security", "platform:k8s"]
}

# Example of a Windows Security Governance Condition
resource "harness_chaos_security_governance_condition" "windows_condition" {
  org_id      = var.org_id
  project_id  = var.project_id
  name        = "windows-security-condition"
  description = "Security governance condition for Windows hosts"
  infra_type  = "Windows"

  fault_spec {
    operator = "NOT_EQUAL_TO"

    faults {
      fault_type = "FAULT"
      name       = "process-kill"
    }

    faults {
      fault_type = "FAULT"
      name       = "cpu-hog"
    }
  }

  machine_spec {
    infra_spec {
      operator  = "EQUAL_TO"
      infra_ids = [var.windows_infra_id]
    }
  }

  tags = ["env:prod", "team:security", "platform:windows"]
}

# Example of a Linux Security Governance Condition
resource "harness_chaos_security_governance_condition" "linux_condition" {
  org_id      = var.org_id
  project_id  = var.project_id
  name        = "linux-security-condition"
  description = "Security governance condition for Linux hosts"
  infra_type  = "Linux"

  fault_spec {
    operator = "NOT_EQUAL_TO"

    faults {
      fault_type = "FAULT"
      name       = "process-kill"
    }

    faults {
      fault_type = "FAULT"
      name       = "memory-hog"
    }
  }

  machine_spec {
    infra_spec {
      operator  = "EQUAL_TO"
      infra_ids = [var.linux_infra_id]
    }
  }

  tags = ["env:prod", "team:security", "platform:linux"]
}

# Output the created conditions
output "k8s_condition_id" {
  value = harness_chaos_security_governance_condition.k8s_condition.id
}

output "windows_condition_id" {
  value = harness_chaos_security_governance_condition.windows_condition.id
}

output "linux_condition_id" {
  value = harness_chaos_security_governance_condition.linux_condition.id
}
```

<!-- schema generated by tfplugindocs -->
## Schema

### Required

- `fault_spec` (Block List, Min: 1, Max: 1) Specification for faults to be included in the condition (see [below for nested schema](#nestedblock--fault_spec))
- `infra_type` (String) Type of infrastructure (Kubernetes, KubernetesV2, Linux, Windows, CloudFoundry, Container)
- `name` (String) Name of the security governance condition
- `org_id` (String) The organization ID of the security governance condition
- `project_id` (String) The project ID of the security governance condition

### Optional

- `description` (String) Description of the security governance condition
- `k8s_spec` (Block List, Max: 1) Kubernetes specific configuration (required when infra_type is KUBERNETES or KUBERNETESV2) (see [below for nested schema](#nestedblock--k8s_spec))
- `machine_spec` (Block List, Max: 1) Machine specific configuration (required when infra_type is LINUX or WINDOWS) (see [below for nested schema](#nestedblock--machine_spec))
- `tags` (List of String) Tags for the security governance condition

### Read-Only

- `id` (String) The ID of this resource.

<a id="nestedblock--fault_spec"></a>
### Nested Schema for `fault_spec`

Required:

- `faults` (Block List, Min: 1) List of fault specifications (see [below for nested schema](#nestedblock--fault_spec--faults))
- `operator` (String) Operator for comparing faults (EQUAL_TO or NOT_EQUAL_TO)

<a id="nestedblock--fault_spec--faults"></a>
### Nested Schema for `fault_spec.faults`

Required:

- `fault_type` (String) Type of the fault (FAULT or FAULT_GROUP)
- `name` (String) Name of the fault



<a id="nestedblock--k8s_spec"></a>
### Nested Schema for `k8s_spec`

Optional:

- `application_spec` (Block List, Max: 1) Application specification (see [below for nested schema](#nestedblock--k8s_spec--application_spec))
- `chaos_service_account_spec` (Block List, Max: 1) Chaos service account specification (see [below for nested schema](#nestedblock--k8s_spec--chaos_service_account_spec))
- `infra_spec` (Block List, Max: 1) Infrastructure specification (see [below for nested schema](#nestedblock--k8s_spec--infra_spec))

<a id="nestedblock--k8s_spec--application_spec"></a>
### Nested Schema for `k8s_spec.application_spec`

Required:

- `operator` (String) Operator for application matching (EQUAL_TO or NOT_EQUAL_TO)

Optional:

- `workloads` (Block List) List of workloads to include/exclude (see [below for nested schema](#nestedblock--k8s_spec--application_spec--workloads))

<a id="nestedblock--k8s_spec--application_spec--workloads"></a>
### Nested Schema for `k8s_spec.application_spec.workloads`

Required:

- `namespace` (String) Namespace of the workload

Optional:

- `application_map_id` (String) ID for the application map
- `kind` (String) Kind of the workload (e.g., deployment, statefulset)
- `label` (String) Label selector for the workload
- `services` (List of String) List of services associated with the workload



<a id="nestedblock--k8s_spec--chaos_service_account_spec"></a>
### Nested Schema for `k8s_spec.chaos_service_account_spec`

Required:

- `operator` (String) Operator for service account matching (EQUAL_TO or NOT_EQUAL_TO)
- `service_accounts` (List of String) List of service accounts to include/exclude


<a id="nestedblock--k8s_spec--infra_spec"></a>
### Nested Schema for `k8s_spec.infra_spec`

Required:

- `infra_ids` (List of String) List of infrastructure IDs to apply the condition to
- `operator` (String) Operator for comparing infrastructure IDs (EQUAL_TO or NOT_EQUAL_TO)



<a id="nestedblock--machine_spec"></a>
### Nested Schema for `machine_spec`

Optional:

- `infra_spec` (Block List, Max: 1) Infrastructure specification (see [below for nested schema](#nestedblock--machine_spec--infra_spec))

<a id="nestedblock--machine_spec--infra_spec"></a>
### Nested Schema for `machine_spec.infra_spec`

Required:

- `infra_ids` (List of String) List of infrastructure IDs to apply the condition to
- `operator` (String) Operator for comparing infrastructure IDs (EQUAL_TO or NOT_EQUAL_TO)

## Import

Import is supported using the following syntax:

The [`terraform import` command](https://developer.hashicorp.com/terraform/cli/commands/import) can be used, for example:

```shell
# Import Project level Chaos Security Governance Condition
terraform import harness_chaos_security_governance_condition.example org_id/project_id/condition_id
```
