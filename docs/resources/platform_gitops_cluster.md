---
# generated by https://github.com/hashicorp/terraform-plugin-docs
page_title: "harness_platform_gitops_cluster Resource - terraform-provider-harness"
subcategory: "Next Gen"
description: |-
  Resource for managing a Harness Gitops Cluster.
---

# harness_platform_gitops_cluster (Resource)

Resource for managing a Harness Gitops Cluster.

## Example Usage

```terraform
# Cluster without Optional tags
resource "harness_platform_gitops_cluster" "example" {
  identifier = "identifier"
  account_id = "account_id"
  project_id = "project_id"
  org_id     = "org_id"
  agent_id   = "agent_id"

  request {
    upsert = false
    cluster {
      server = "https://kubernetes.default.svc"
      name   = "name"
      config {
        tls_client_config {
          insecure = true
        }
        cluster_connection_type = "IN_CLUSTER"
      }

    }
  }
  lifecycle {
    ignore_changes = [
      request.0.upsert, request.0.cluster.0.config.0.bearer_token,
    ]
  }
}

# Cluster with Optional tags. Cluster at org scope with an account level agent.
resource "harness_platform_gitops_cluster" "example" {
  identifier = "identifier"
  account_id = "account_id"
  org_id     = "org_id"
  agent_id   = "account.agent_id"

  request {
    upsert = false
    tags = [
      "foo:bar",
    ]
    cluster {
      server = "https://kubernetes.default.svc"
      name   = "name"
      config {
        tls_client_config {
          insecure = true
        }
        cluster_connection_type = "IN_CLUSTER"
      }

    }
  }
  lifecycle {
    ignore_changes = [
      request.0.upsert, request.0.cluster.0.config.0.bearer_token,
    ]
  }
}


# Cluster with self signed certificate
resource "harness_platform_gitops_cluster" "example" {
  identifier = "identifier"
  account_id = "account_id"
  project_id = "project_id"
  org_id     = "org_id"
  agent_id   = "agent_id"

  request {
    upsert = false
    cluster {
      server = "https://1.2.3.4"
      name   = "name"
      config {
        tls_client_config {
          ca_data      = "LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tClhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWApYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFgKLS0tLS1FTkQgQ0VSVElGSUNBVEUtLS0tLQ=="
        }
        bearer_token = "ey......X"
        cluster_connection_type = "SERVICE_ACCOUNT"
      }

    }
  }
  lifecycle {
    ignore_changes = [
      request.0.upsert, request.0.cluster.0.config.0.bearer_token,
    ]
  }
}
```

<!-- schema generated by tfplugindocs -->
## Schema

### Required

- `agent_id` (String) Agent identifier of the GitOps cluster. (include scope prefix)
- `identifier` (String) Identifier of the GitOps cluster.

### Optional

- `account_id` (String, Deprecated) Account identifier of the GitOps cluster.
- `org_id` (String) Organization identifier of the cluster.
- `project_id` (String) Project identifier of the GitOps cluster.
- `force_delete` (Boolean) Indicates if the cluster should be deleted forcefully, regardless of existing applications using that cluster.
- `request` (Block List, Max: 1) Cluster create or update request. (see [below for nested schema](#nestedblock--request))

### Read-Only

- `id` (String) The ID of this resource.

<a id="nestedblock--request"></a>
### Nested Schema for `request`

Optional:

- `cluster` (Block List, Max: 1) GitOps cluster details. (see [below for nested schema](#nestedblock--request--cluster))
- `tags` (Set of String) Tags for the GitOps cluster. These can be used to search or filter the GitOps agents.
- `updated_fields` (List of String) Fields which are updated.
- `upsert` (Boolean) Indicates if the GitOps cluster should be updated if existing and inserted if not.

<a id="nestedblock--request--cluster"></a>
### Nested Schema for `request.cluster`

Required:

- `config` (Block List, Min: 1, Max: 1) GitOps cluster config. (see [below for nested schema](#nestedblock--request--cluster--config))
- `server` (String) API server URL of the kubernetes cluster.

Optional:

- `annotations` (Map of String) Annotations for cluster secret metadata.
- `cluster_resources` (Boolean) Indicates if cluster level resources should be managed. This setting is used only if cluster is connected in a namespaced mode.
- `labels` (Map of String) Labels for cluster secret metadata.
- `name` (String) Name of the cluster. If omitted, the server address will be used.
- `namespaces` (List of String) List of namespaces which are accessible in that cluster. Cluster level resources will be ignored if namespace list is not empty.
- `project` (String) The ArgoCD project name corresponding to this GitOps cluster. An empty string means that the GitOps cluster belongs to the default project created by Harness.
- `refresh_requested_at` (Block List, Max: 1) Time when cluster cache refresh has been requested. (see [below for nested schema](#nestedblock--request--cluster--refresh_requested_at))
- `shard` (String) Shard number to be managed by a specific application controller pod. Calculated on the fly by the application controller if not specified.

Read-Only:

- `info` (List of Object) Information about cluster cache and state. (see [below for nested schema](#nestedatt--request--cluster--info))

<a id="nestedblock--request--cluster--config"></a>
### Nested Schema for `request.cluster.config`

Optional:

- `aws_cluster_name` (String) AWS Cluster name. If set then AWS CLI EKS token command will be used to access cluster.
- `bearer_token` (String, Sensitive) Bearer authentication token the cluster.
- `cluster_connection_type` (String) Identifies the authentication method used to connect to the cluster.
- `disable_compression` (Boolean) DisableCompression bypasses automatic GZip compression requests to to the cluster's API server. Corresponds to running kubectl with --disable-compression
- `exec_provider_config` (Block List, Max: 1) Configuration for an exec provider. (see [below for nested schema](#nestedblock--request--cluster--config--exec_provider_config))
- `password` (String) Password of the server of the cluster.
- `proxy_url` (String) The URL to the proxy to be used for all requests send to the cluster's API server
- `role_a_r_n` (String) Optional role ARN. If set then used for AWS IAM Authenticator.
- `tls_client_config` (Block List, Max: 1) Settings to enable transport layer security. (see [below for nested schema](#nestedblock--request--cluster--config--tls_client_config))
- `username` (String) Username of the server of the cluster.

<a id="nestedblock--request--cluster--config--exec_provider_config"></a>
### Nested Schema for `request.cluster.config.exec_provider_config`

Optional:

- `api_version` (String) Preferred input version of the ExecInfo.
- `args` (List of String) Arguments to pass to the command when executing it.
- `command` (String) Command to execute.
- `env` (Map of String) Additional environment variables to expose to the process.
- `install_hint` (String) Message displayed when the executable is not found.


<a id="nestedblock--request--cluster--config--tls_client_config"></a>
### Nested Schema for `request.cluster.config.tls_client_config`

Optional:

- `ca_data` (String) CA data holds PEM-encoded bytes (typically read from a root certificates bundle). Use this if you are using self-signed certificates. CAData takes precedence over CAFile. The value should be base64 encoded.
- `cert_data` (String) Certificate data holds PEM-encoded bytes (typically read from a client certificate file). CertData takes precedence over CertFile. Use this if you are using mTLS. The value should be base64 encoded.
- `insecure` (Boolean) Indicates if the TLS connection to the cluster should be insecure.
- `key_data` (String) Key data holds PEM-encoded bytes (typically read from a client certificate key file). KeyData takes precedence over KeyFile. Use this if you are using mTLS. The value should be base64 encoded.
- `server_name` (String) Server name for SNI in the client to check server certificates against. If ServerName is empty, the hostname used to contact the server is used.



<a id="nestedblock--request--cluster--refresh_requested_at"></a>
### Nested Schema for `request.cluster.refresh_requested_at`

Optional:

- `nanos` (Number) Non-negative fractions of a second at nanosecond resolution. Negative second values with fractions must still have non-negative nanos values that count forward in time. Must be from 0 to 999,999,999 inclusive. This field may be limited in precision depending on context.
- `seconds` (String) Represents seconds of UTC time since Unix epoch 1970-01-01T00:00:00Z. Must be from 0001-01-01T00:00:00Z to 9999-12-31T23:59:59Z inclusive.


<a id="nestedatt--request--cluster--info"></a>
### Nested Schema for `request.cluster.info`

Read-Only:

- `api_versions` (List of String)
- `applications_count` (String)
- `cache_info` (List of Object) (see [below for nested schema](#nestedobjatt--request--cluster--info--cache_info))
- `connection_state` (List of Object) (see [below for nested schema](#nestedobjatt--request--cluster--info--connection_state))
- `server_version` (String)

<a id="nestedobjatt--request--cluster--info--cache_info"></a>
### Nested Schema for `request.cluster.info.cache_info`

Read-Only:

- `apis_count` (String)
- `last_cache_sync_time` (String)
- `resources_count` (String)


<a id="nestedobjatt--request--cluster--info--connection_state"></a>
### Nested Schema for `request.cluster.info.connection_state`

Read-Only:

- `attempted_at` (List of Object) (see [below for nested schema](#nestedobjatt--request--cluster--info--connection_state--attempted_at))
- `message` (String)
- `status` (String)

<a id="nestedobjatt--request--cluster--info--connection_state--attempted_at"></a>
### Nested Schema for `request.cluster.info.connection_state.attempted_at`

Read-Only:

- `nanos` (Number)
- `seconds` (String)

## Import

Import is supported using the following syntax:

```shell
# Import an Account level Gitops Cluster
terraform import harness_platform_gitops_cluster.example <agent_id>/<cluster_id>

# Import an Org level Gitops Cluster
terraform import harness_platform_gitops_cluster.example <organization_id>/<agent_id>/<cluster_id>

# Import a Project level Gitops Cluster
terraform import harness_platform_gitops_cluster.example <organization_id>/<project_id>/<agent_id>/<cluster_id>
```
